<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>樱兰学院咖啡谷</title>
  <style>
    body{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,"Noto Sans",sans-serif;margin:16px;line-height:1.5}
    h1{font-size:22px;margin:0 0 8px;font-weight:900}
    .hint{color:#555;font-size:13px;margin:0 0 16px}
    table{width:100%;border-collapse:collapse}
    th,td{border:1px solid #ddd;padding:10px;vertical-align:top}
    th{background:#f7f7f7;text-align:left;font-weight:700;white-space:nowrap}
    img{width:180px;max-width:100%;height:auto;border-radius:10px;border:1px solid #eee}
    .zh{font-size:16px;font-weight:900}
    .ja{color:#666;font-size:12px;margin-top:2px}
    .sub{color:#666;font-size:12px;margin-top:6px}
    .num{width:84px}
    .right{text-align:right;white-space:nowrap}
    .totalbar{display:flex;gap:12px;align-items:center;justify-content:flex-end;margin-top:12px}
    .total{font-size:18px;font-weight:900}
    .btn{padding:8px 12px;border:1px solid #ccc;border-radius:10px;background:#fff;cursor:pointer}
    .btn:hover{background:#f4f4f4}
    @media (max-width:900px){
      img{width:140px}
      th:nth-child(3),td:nth-child(3){display:none;} /* 手机端可隐藏“商品类型”，不想隐藏就删这行 */
    }
  </style>
</head>
<body>
  <h1><strong>樱兰学院咖啡谷</strong></h1>
  <p class="hint">欢迎使用自助下单系统，联系微信咨询或获取报价。</p>

  <table id="goodsTable">
    <thead>
      <tr>
        <th>图片</th>
        <th>商品名</th>
        <th>商品类型</th>
        <th class="right">每张票限购</th>
        <th class="right">单价</th>
        <th class="right">希望数量</th>
        <th class="right">小计</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="totalbar">
    <button class="btn" id="resetBtn">清空数量</button>
    <div class="total">总价：<span id="grandTotal">¥0</span></div>
  </div>

<script>
  // 你的页面在 tokyo/goods.html，所以图片目录在上一级
  const IMG_BASE = "../assets/images/tokyo/goods/";

  const items = [
    // 1 亚克力立牌（拆成最小单位：每个角色一行）
    {img:"goods-20251224-1.png", zh:"亚克力立牌｜藤冈春日", ja:"アクリルスタンド｜藤岡 ハルヒ", type:"亚克力周边", limit:3, price:1650},
    {img:"goods-20251224-1.png", zh:"亚克力立牌｜须王环",   ja:"アクリルスタンド｜須王 環",     type:"亚克力周边", limit:3, price:1650},
    {img:"goods-20251224-1.png", zh:"亚克力立牌｜凤镜夜",   ja:"アクリルスタンド｜鳳 鏡夜",     type:"亚克力周边", limit:3, price:1650},
    {img:"goods-20251224-1.png", zh:"亚克力立牌｜常陆院光", ja:"アクリルスタンド｜常陸院 光",   type:"亚克力周边", limit:3, price:1650},
    {img:"goods-20251224-1.png", zh:"亚克力立牌｜常陆院馨", ja:"アクリルスタンド｜常陸院 馨",   type:"亚克力周边", limit:3, price:1650},
    {img:"goods-20251224-1.png", zh:"亚克力立牌｜埴之冢光邦（Honey）", ja:"アクリルスタンド｜埴之塚 光邦", type:"亚克力周边", limit:3, price:1650},
    {img:"goods-20251224-1.png", zh:"亚克力立牌｜铦之冢崇（Mori）",   ja:"アクリルスタンド｜銛之塚 崇",   type:"亚克力周边", limit:3, price:1650},

    // 2 盲抽 标记亚克力钥匙扣
    {img:"goods-20251224-2.png", zh:"盲抽 标记亚克力钥匙扣（单抽）", ja:"トレーディングめじるしアクキー（単品）", type:"盲抽/钥匙扣", limit:20, price:660},
    {img:"goods-20251224-2.png", zh:"标记亚克力钥匙扣（整套）",       ja:"トレーディングめじるしアクキー（コンプリートセット）", type:"盲抽/整套", limit:2,  price:6600},

    // 3 盲抽 镭射徽章
    {img:"goods-20251224-3.png", zh:"盲抽 镭射徽章（单抽）", ja:"トレーディングホログラム缶バッジ（単品）", type:"盲抽/徽章", limit:14, price:550},
    {img:"goods-20251224-3.png", zh:"镭射徽章（整套）",       ja:"トレーディングホログラム缶バッジ（コンプリートセット）", type:"盲抽/整套", limit:2,  price:3850},

    // 4 盲抽 亚克力杯垫
    {img:"goods-20251224-4.png", zh:"盲抽 亚克力杯垫（单抽）", ja:"トレーディングアクリルコースター（単品）", type:"盲抽/杯垫", limit:30, price:770},
    {img:"goods-20251224-4.png", zh:"亚克力杯垫（整套）",       ja:"トレーディングアクリルコースター（コンプリートセット）", type:"盲抽/整套", limit:2,  price:11550},

    // 5 文件夹
    {img:"goods-20251224-5.png", zh:"透明文件夹 2枚套装", ja:"クリアファイル2枚セット", type:"文具/纸品", limit:3, price:880},

    // 6 滑动亚克力钥匙扣（拆成最小单位：每个款式一行）
    {img:"goods-20251224-6.png", zh:"滑动亚克力钥匙扣 A（春日&环）",   ja:"スライドアクキー A（ハルヒ&環）",   type:"钥匙扣", limit:3, price:1100},
    {img:"goods-20251224-6.png", zh:"滑动亚克力钥匙扣 B（环&镜夜）",   ja:"スライドアクキー B（環&鏡夜）",     type:"钥匙扣", limit:3, price:1100},
    {img:"goods-20251224-6.png", zh:"滑动亚克力钥匙扣 C（光&馨）",     ja:"スライドアクキー C（光&馨）",       type:"钥匙扣", limit:3, price:1100},
    {img:"goods-20251224-6.png", zh:"滑动亚克力钥匙扣 D（Honey&Mori）",ja:"スライドアクキー D（ハニー&モリ）", type:"钥匙扣", limit:3, price:1100},

    // 7 盲抽 亚克力卡
    {img:"goods-20251224-7.png", zh:"盲抽 亚克力卡（单抽）", ja:"トレーディングアクリルカード（単品）", type:"盲抽/卡片", limit:14, price:660},
    {img:"goods-20251224-7.png", zh:"亚克力卡（整套）",       ja:"トレーディングアクリルカード（コンプリートセット）", type:"盲抽/整套", limit:2,  price:4620},

    // 8 束口袋
    {img:"goods-20251224-8.png", zh:"抽绳束口袋", ja:"巾着", type:"袋子/收纳", limit:3, price:1650},

    // 9 盲抽 透明卡
    {img:"goods-20251224-9.png", zh:"盲抽 透明卡收藏（单抽）", ja:"トレーディングクリアカードコレクション（単品）", type:"盲抽/卡片", limit:24, price:660},
    {img:"goods-20251224-9.png", zh:"透明卡收藏（整套）",       ja:"トレーディングクリアカードコレクション（コンプリートセット）", type:"盲抽/整套", limit:2,  price:7920},

    // 10 明信片
    {img:"goods-20251224-10.png", zh:"明信片套装（12张）", ja:"ポストカードセット", type:"纸品", limit:3, price:1540},

    // 11 亚克力迷你色纸板
    {img:"goods-20251224-11.png", zh:"亚克力迷你色纸板", ja:"アクリルミニ色紙", type:"亚克力周边", limit:3, price:2200},

    // 12 证件照贴纸
    {img:"goods-20251224-12.png", zh:"证件照贴纸", ja:"証明写真シール", type:"贴纸", limit:3, price:880},

    // 13 相片夹
    {img:"goods-20251224-13.png", zh:"亚克力相片夹 A（钥匙扣款）", ja:"アクリルフォトケース A（キーホルダー）", type:"亚克力周边", limit:3, price:1210},
    {img:"goods-20251224-13.png", zh:"亚克力相片夹 B（支架款）",   ja:"アクリルフォトケース B（スタンド）",     type:"亚克力周边", limit:3, price:2310},

    // 15 扭蛋
    {img:"goods-20251224-15.png", zh:"亚克力旅馆钥匙牌钥匙扣（扭蛋）", ja:"アクリルモーテルキーホルダー（カプセルトイ）", type:"扭蛋", limit:3, price:660},
  ];

  const yen = (n)=> new Intl.NumberFormat("ja-JP").format(n);
  const tbody = document.querySelector("#goodsTable tbody");
  const grandTotalEl = document.getElementById("grandTotal");

  function render(){
    tbody.innerHTML = "";
    items.forEach((it)=>{
      const max = (typeof it.limit === "number") ? it.limit : 999;

      const tr = document.createElement("tr");
      tr.dataset.price = it.price;
      tr.dataset.max = max;

      tr.innerHTML = `
        <td>
          <img src="${IMG_BASE + it.img}" alt="${it.zh}">
          <div class="sub">${it.img}</div>
        </td>
        <td>
          <div class="zh">${it.zh}</div>
          <div class="ja">${it.ja}</div>
        </td>
        <td>${it.type}</td>
        <td class="right">${(typeof it.limit==="number") ? it.limit : "—"}</td>
        <td class="right">¥${yen(it.price)}</td>
        <td class="right">
          <input class="num" type="number" min="0" max="${max}" step="1" value="0" inputmode="numeric" />
        </td>
        <td class="right"><span class="subtotal">¥0</span></td>
      `;

      const input = tr.querySelector("input");
      const subtotalEl = tr.querySelector(".subtotal");

      function recalcRow(){
        let qty = parseInt(input.value || "0", 10);
        if (Number.isNaN(qty) || qty < 0) qty = 0;
        if (qty > max) qty = max;
        input.value = qty;

        const sub = qty * it.price;
        subtotalEl.textContent = "¥" + yen(sub);
        recalcTotal();
      }

      input.addEventListener("input", recalcRow);
      input.addEventListener("change", recalcRow);

      tbody.appendChild(tr);
    });

    recalcTotal();
  }

  function recalcTotal(){
    let total = 0;
    [...tbody.querySelectorAll("tr")].forEach(tr=>{
      const price = parseInt(tr.dataset.price, 10) || 0;
      const qty = parseInt(tr.querySelector("input").value || "0", 10) || 0;
      total += price * qty;
    });
    grandTotalEl.textContent = "¥" + yen(total);
  }

  document.getElementById("resetBtn").addEventListener("click", ()=>{
    tbody.querySelectorAll("input").forEach(i=> i.value = 0);
    tbody.querySelectorAll(".subtotal").forEach(s=> s.textContent = "¥0");
    recalcTotal();
  });

  render();
</script>
</body>
</html>
