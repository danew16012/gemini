<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GOODS 订购表</title>
  <style>
    body{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,"Noto Sans",sans-serif;margin:16px;line-height:1.5}
    h1{font-size:20px;margin:0 0 12px}
    .hint{color:#555;font-size:13px;margin:0 0 16px}
    table{width:100%;border-collapse:collapse}
    th,td{border:1px solid #ddd;padding:10px;vertical-align:top}
    th{background:#f7f7f7;text-align:left;font-weight:600;white-space:nowrap}
    img{width:180px;max-width:100%;height:auto;border-radius:8px;border:1px solid #eee}
    .name{font-weight:700}
    .sub{color:#666;font-size:13px}
    .num{width:84px}
    .right{text-align:right;white-space:nowrap}
    .totalbar{display:flex;gap:12px;align-items:center;justify-content:flex-end;margin-top:12px}
    .total{font-size:18px;font-weight:800}
    .btn{padding:8px 12px;border:1px solid #ccc;border-radius:10px;background:#fff;cursor:pointer}
    .btn:hover{background:#f4f4f4}
    @media (max-width:900px){
      img{width:140px}
      th:nth-child(4),td:nth-child(4),th:nth-child(5),td:nth-child(5){display:none;} /* 手机端隐藏“类型/限购”可按需删 */
    }
  </style>
</head>
<body>
  <h1>GOODS 订购表（自动算总价）</h1>
  <p class="hint">
    单位：日元（含税）。数量输入后会自动计算小计与总价。限购按图上标注填写；没有标注的我用“—”表示。
  </p>

  <table id="goodsTable">
    <thead>
      <tr>
        <th>图片</th>
        <th>商品名（日 / 中）</th>
        <th>商品类型</th>
        <th class="right">限购</th>
        <th class="right">单价</th>
        <th class="right">希望数量</th>
        <th class="right">小计</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="totalbar">
    <button class="btn" id="resetBtn">清空数量</button>
    <div class="total">总价：<span id="grandTotal">¥0</span></div>
  </div>

<script>
  // 如果你的页面不在 tokyo/ 目录，把下面的 IMG_BASE 改成正确相对路径
  const IMG_BASE = "../assets/images/tokyo/goods/";

  const items = [
    {img:"goods-20251224-1.png",  ja:"アクリルスタンド", zh:"亚克力立牌", type:"亚克力周边", limit:3,  price:1650, note:"（多款角色，按“各”计）"},

    {img:"goods-20251224-2.png",  ja:"トレーディングめじるしアクキー（単品）", zh:"盲抽 标记亚克力钥匙扣（单抽）", type:"盲抽/钥匙扣", limit:20, price:660},
    {img:"goods-20251224-2.png",  ja:"トレーディングめじるしアクキー（コンプリートセット）", zh:"标记亚克力钥匙扣（整套）", type:"盲抽/整套", limit:2,  price:6600},

    {img:"goods-20251224-3.png",  ja:"トレーディングホログラム缶バッジ（単品）", zh:"盲抽 镭射徽章（单抽）", type:"盲抽/徽章", limit:14, price:550},
    {img:"goods-20251224-3.png",  ja:"トレーディングホログラム缶バッジ（コンプリートセット）", zh:"镭射徽章（整套）", type:"盲抽/整套", limit:2,  price:3850},

    {img:"goods-20251224-4.png",  ja:"トレーディングアクリルコースター（単品）", zh:"盲抽 亚克力杯垫（单抽）", type:"盲抽/杯垫", limit:30, price:770},
    {img:"goods-20251224-4.png",  ja:"トレーディングアクリルコースター（コンプリートセット）", zh:"亚克力杯垫（整套）", type:"盲抽/整套", limit:2,  price:11550},

    {img:"goods-20251224-5.png",  ja:"クリアファイル2枚セット", zh:"透明文件夹 2枚套装", type:"文件/文具", limit:3,  price:880},

    {img:"goods-20251224-6.png",  ja:"スライドアクキー", zh:"滑动亚克力钥匙扣", type:"钥匙扣", limit:3,  price:1100, note:"（多款，按“各”计）"},

    {img:"goods-20251224-7.png",  ja:"トレーディングアクリルカード（単品）", zh:"盲抽 亚克力卡（单抽）", type:"盲抽/卡片", limit:14, price:660},
    {img:"goods-20251224-7.png",  ja:"トレーディングアクリルカード（コンプリートセット）", zh:"亚克力卡（整套）", type:"盲抽/整套", limit:2,  price:4620},

    {img:"goods-20251224-8.png",  ja:"巾着", zh:"抽绳束口袋", type:"袋子/收纳", limit:3,  price:1650},

    {img:"goods-20251224-9.png",  ja:"トレーディングクリアカードコレクション（単品）", zh:"盲抽 透明卡收藏（单抽）", type:"盲抽/卡片", limit:24, price:660},
    {img:"goods-20251224-9.png",  ja:"トレーディングクリアカードコレクション（コンプリートセット）", zh:"透明卡收藏（整套）", type:"盲抽/整套", limit:2,  price:7920},

    {img:"goods-20251224-10.png", ja:"ポストカードセット", zh:"明信片套装（12张）", type:"纸品", limit:3,  price:1540},

    {img:"goods-20251224-11.png", ja:"アクリルミニ色紙", zh:"亚克力迷你色纸板", type:"亚克力周边", limit:3,  price:2200},

    {img:"goods-20251224-12.png", ja:"証明写真シール", zh:"证件照贴纸", type:"贴纸", limit:3,  price:880},

    {img:"goods-20251224-13.png", ja:"アクリルフォトケース A（キーホルダー）", zh:"亚克力相片夹 A（钥匙扣款）", type:"亚克力周边", limit:3,  price:1210},
    {img:"goods-20251224-13.png", ja:"アクリルフォトケース B（スタンド）", zh:"亚克力相片夹 B（支架款）", type:"亚克力周边", limit:3,  price:2310},

    {img:"goods-20251224-15.png", ja:"アクリルモーテルキーホルダー（カプセルトイ）", zh:"亚克力旅馆钥匙牌钥匙扣（扭蛋/胶囊）", type:"扭蛋", limit:3, price:660, note:"（图上是“每人最多3回”）"},

    {img:"goods-20251224-14.png", ja:"ペアグラス（受注商品）", zh:"对杯（受注/预订）", type:"受注商品", limit:null, price:8800, note:"（图上标注含运费）"},
    {img:"goods-20251224-16.png", ja:"複製原画（受注商品）", zh:"高精度复制原画（受注/预订）", type:"受注商品", limit:null, price:25300, note:"（图上说明另收配送费）"},
  ];

  const yen = (n)=> new Intl.NumberFormat("ja-JP").format(n);
  const tbody = document.querySelector("#goodsTable tbody");
  const grandTotalEl = document.getElementById("grandTotal");

  function render(){
    tbody.innerHTML = "";
    items.forEach((it, idx)=>{
      const max = (typeof it.limit === "number") ? it.limit : 999;
      const tr = document.createElement("tr");
      tr.dataset.price = it.price;

      tr.innerHTML = `
        <td>
          <img src="${IMG_BASE + it.img}" alt="${it.ja}">
          <div class="sub">${it.img}</div>
        </td>
        <td>
          <div class="name">${it.ja}</div>
          <div class="sub">${it.zh}${it.note ? " " + it.note : ""}</div>
        </td>
        <td>${it.type}</td>
        <td class="right">${(typeof it.limit==="number") ? it.limit : "—"}</td>
        <td class="right">¥${yen(it.price)}</td>
        <td class="right">
          <input class="num" type="number" min="0" max="${max}" step="1" value="0" inputmode="numeric" />
        </td>
        <td class="right"><span class="subtotal">¥0</span></td>
      `;

      const input = tr.querySelector("input");
      const subtotalEl = tr.querySelector(".subtotal");

      function recalcRow(){
        let qty = parseInt(input.value || "0", 10);
        if (Number.isNaN(qty) || qty < 0) qty = 0;
        if (qty > max) qty = max;
        input.value = qty;

        const sub = qty * it.price;
        subtotalEl.textContent = "¥" + yen(sub);
        recalcTotal();
      }

      input.addEventListener("input", recalcRow);
      input.addEventListener("change", recalcRow);

      tbody.appendChild(tr);
    });

    recalcTotal();
  }

  function recalcTotal(){
    let total = 0;
    [...tbody.querySelectorAll("tr")].forEach(tr=>{
      const price = parseInt(tr.dataset.price, 10) || 0;
      const qty = parseInt(tr.querySelector("input").value || "0", 10) || 0;
      total += price * qty;
    });
    grandTotalEl.textContent = "¥" + yen(total);
  }

  document.getElementById("resetBtn").addEventListener("click", ()=>{
    tbody.querySelectorAll("input").forEach(i=> i.value = 0);
    tbody.querySelectorAll(".subtotal").forEach(s=> s.textContent = "¥0");
    recalcTotal();
  });

  render();
</script>
</body>
</html>
